<h1><b>Shounen RSA</b></h1>
<p> Diberikan 1 file flag.enc dan 1 encrypt.py
<p align="center">
  <img src="https://github.com/enomarozi/RSA-CTF-Writeup/blob/master/RSA/Image/Shounen%20RSA.png">
</p>
<h3><b>Solution</b></h3>
<p>sudah dipastikan file encrypt.py yang melakukan encrypt ke plaintext dari flag</p>

```python
from flag import flag
from base64 import b64encode as be
from Crypto.Util.number import *
import json

flag = bytes_to_long(flag)

p = getPrime(512)
q = getPrime(512)
x1 = getRandomInteger(8)
x2 = getRandomInteger(8)
n = p*q

c = pow(flag,177013,n)

obj = {
    'ciphertext' : c,
    'n' : n,
    'p1' : p^x1,
    'p2' : q^x2,
}

with open('flag.enc','w') as output:
    output.write(be(bytes(json.dumps(obj).encode('utf-8'))).decode())
```
<p>Disini kita diminta untuk menjadi cryptanalysis untuk me-reverse 
ciphertext ke plaintext yang hanya bermodal file encrypt dan proses encrypt tanpa key</p>
<p>Pada proses encrypt terdapat generate random bilangan prima <b>getRandomInteger(8)</b> yang artinya
ketika program di-run akan menghasilkan ciphertext berbeda setiap saat, karna nilai dari p dan q selalu dikali
dengan bilangan prima acak < 256, jadi tahap awal untuk me-reverse flag yaitu mencari nilai random x1 dan x2 yang sudah dikali 
pada p1 dan p2 file flag.enc</p>

<p>Nilai eksponen sudah ada pada file encrypt.py, dan untuk c,n,p1,p2 decode file flag.enc</p>
<pre>
e : 177013 
c : 74694720655728220506199956646054705038827898893413192027622794921011348182932037537978061605690153526827461217776522851963369960212705416414663675480610357327075507558847352013139418154247635487148483428537387875893716906007027294144455759861446921192734255282732938945896441610540480405933441430686032303045
n : 119758143150715844794523698096721330247524109571634075527103577707825897013471360584264933622391489296401611997761943930768049853232998277177637756526992791508970378918600477258387818613304479356416227682804111442014235565488827909144022760675598473356262044099098951585474654251922898584690498955105358414361
p1 : 12240781795671897131351327803461734465905275407347397500791318723608580094755361016840513671122050635820297821572984881149288942905121013298799464839009724
p2 : 9783537126122123988487700121168882537633616239982351969208321537798192937111335928885521429793284494278667370957318876568363436093122884914274650811065450
</pre>
<p>Cari nilai x1 dan x2 dari p1 dan p2</p>

```python
n = 119758143150715844794523698096721330247524109571634075527103577707825897013471360584264933622391489296401611997761943930768049853232998277177637756526992791508970378918600477258387818613304479356416227682804111442014235565488827909144022760675598473356262044099098951585474654251922898584690498955105358414361
p1 = 12240781795671897131351327803461734465905275407347397500791318723608580094755361016840513671122050635820297821572984881149288942905121013298799464839009724
p2 = 9783537126122123988487700121168882537633616239982351969208321537798192937111335928885521429793284494278667370957318876568363436093122884914274650811065450
for x1 in range(1,257):
    for x2 in range(1,257):
        p = p1 ^ x1
        q = p2 ^ x2
        if p*q == n:
            print("x1 : ",x1)
            print("x2 : ",x2)
```
<p>Hasil</p>
<pre>
x1 :  195
x2 :  13
</pre>
<p>Terakhir decrypt ciphertext(c)</p>

```python
import gmpy2

e = 177013
c = 74694720655728220506199956646054705038827898893413192027622794921011348182932037537978061605690153526827461217776522851963369960212705416414663675480610357327075507558847352013139418154247635487148483428537387875893716906007027294144455759861446921192734255282732938945896441610540480405933441430686032303045
n = 119758143150715844794523698096721330247524109571634075527103577707825897013471360584264933622391489296401611997761943930768049853232998277177637756526992791508970378918600477258387818613304479356416227682804111442014235565488827909144022760675598473356262044099098951585474654251922898584690498955105358414361
p1 = 12240781795671897131351327803461734465905275407347397500791318723608580094755361016840513671122050635820297821572984881149288942905121013298799464839009724
p2 = 9783537126122123988487700121168882537633616239982351969208321537798192937111335928885521429793284494278667370957318876568363436093122884914274650811065450
p =  p1 ^ 195
q =  p2 ^ 13
phi = (p-1)*(q-1) 
d = gmpy2.invert(e,phi)
print(bytes.fromhex(hex(pow(c,d,n))[2:]).decode("ascii"))
```
<h3><b>Flag</b></h3>
<pre>
flag{p1us_ul7ra!!!}
</pre>
