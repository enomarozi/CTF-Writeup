<h1><b>Complex RSA</b></h1>
<p align="center">
  <img src="https://github.com/enomarozi/RSA-CTF-Writeup/blob/master/RSA/Image/Complex%20RSA.png">
</p>
<p>Pada soal diberikan 3 file (1 flag.enc dan 2 pubkey). Generate modulus(n) dan exponent(e) dari setiap file pubkey</p>
<p>pubkey1 : <b>openssl rsa -in pubkey1 -pubin -text -noout</b></p>
<pre>
RSA Public-Key: (1026 bit)
Modulus:
    03:15:4c:a2:cd:44:39:ad:97:e0:38:7a:51:4c:97:
    bf:21:0c:f7:5f:3b:cf:26:25:94:68:3b:b5:3c:e6:
    99:48:12:df:6a:19:55:c4:4f:9f:12:e9:9c:2a:69:
    8c:b9:7f:0e:47:e8:e8:d1:48:a7:f3:47:2d:2b:4d:
    e2:54:10:ad:f2:1e:49:8b:b9:b4:66:5a:0c:66:d8:
    d2:66:ff:20:63:7e:ac:f2:71:8d:9a:59:c1:c4:a3:
    cf:02:2f:0b:f2:8d:53:89:d5:86:41:f3:dd:99:4e:
    f2:ff:fa:4b:70:d3:d3:98:e9:48:42:00:f8:77:93:
    06:10:13:a8:ed:07:2c:d7:7f
Exponent: 37507589401 (0x8bba06519)
</pre>
<p>pubkey2 : <b>openssl rsa -in pubkey2 -pubin -text -noout</b></p>
<pre>
RSA Public-Key: (1026 bit)
Modulus:
    03:15:4c:a2:cd:44:39:ad:97:e0:38:7a:51:4c:97:
    bf:21:0c:f7:5f:3b:cf:26:25:94:68:3b:b5:3c:e6:
    99:48:12:df:6a:19:55:c4:4f:9f:12:e9:9c:2a:69:
    8c:b9:7f:0e:47:e8:e8:d1:48:a7:f3:47:2d:2b:4d:
    e2:54:10:ad:f2:1e:49:8b:b9:b4:66:5a:0c:66:d8:
    d2:66:ff:20:63:7e:ac:f2:71:8d:9a:59:c1:c4:a3:
    cf:02:2f:0b:f2:8d:53:89:d5:86:41:f3:dd:99:4e:
    f2:ff:fa:4b:70:d3:d3:98:e9:48:42:00:f8:77:93:
    06:10:13:a8:ed:07:2c:d7:7f
Exponent:
    1a:1b:48:c3:a6:ce:4a:6a:f6:e3:cb:78:c5:5f:ac:
    7f:59:29:6f:41:bb:11:e5:8a:30:1f:b8:d2:f3:c4:
    7e:bb:15:fa:3e:68:e9:f7:7f:8c:52:39:3b:e2:22:
    17:5d:e4:a7:bc:55:d9:9d:51:80:1b:5a:1d:be:72:
    dd:6e:ff:ae:52:39:f3:a4:48:d3:e9:ef:5a:a1:c9:
    54:5e:1a:38:49:18:9b:e6:3c:49:fe:3b:94:92:54:
    d4:20:d9:81:76:77:a7:db:4a:d1:f3:f5:df:99:b3:
    25:7d:d6:04:c5:72:ce:e2:5e:43:c2:69:43:cf:d1:
    64:91:80:3b
</pre>
<p>Sepertinya nilai modulus(n) dari kedua pubkey itu sama, dan terdapat 2 big eksponen(e) yang berbeda. bisa kita asumsikan
kalau pesan/flag di encrypt dengan 2 kunci</p>
<p>Generate desimal masing-masing pubkey</p>

```python3

n1 = int("0x03:15:4c:a2:cd:44:39:ad:97:e0:38:7a:51:4c:97:bf:21:0c:f7:5f:3b:cf:26:25:94:68:3b:b5:3c:e6:99:48:12:df:6a:19:55:c4:4f:9f:12:e9:9c:2a:69:8c:b9:7f:0e:47:e8:e8:d1:48:a7:f3:47:2d:2b:4d:e2:54:10:ad:f2:1e:49:8b:b9:b4:66:5a:0c:66:d8:d2:66:ff:20:63:7e:ac:f2:71:8d:9a:59:c1:c4:a3:cf:02:2f:0b:f2:8d:53:89:d5:86:41:f3:dd:99:4e:f2:ff:fa:4b:70:d3:d3:98:e9:48:42:00:f8:77:93:06:10:13:a8:ed:07:2c:d7:7f".replace(":",""),0)
e1 = 0x8bba06519
n2 = int("0x03:15:4c:a2:cd:44:39:ad:97:e0:38:7a:51:4c:97:bf:21:0c:f7:5f:3b:cf:26:25:94:68:3b:b5:3c:e6:99:48:12:df:6a:19:55:c4:4f:9f:12:e9:9c:2a:69:8c:b9:7f:0e:47:e8:e8:d1:48:a7:f3:47:2d:2b:4d:e2:54:10:ad:f2:1e:49:8b:b9:b4:66:5a:0c:66:d8:d2:66:ff:20:63:7e:ac:f2:71:8d:9a:59:c1:c4:a3:cf:02:2f:0b:f2:8d:53:89:d5:86:41:f3:dd:99:4e:f2:ff:fa:4b:70:d3:d3:98:e9:48:42:00:f8:77:93:06:10:13:a8:ed:07:2c:d7:7f".replace(":",""),0)
e2 = int("0x1a:1b:48:c3:a6:ce:4a:6a:f6:e3:cb:78:c5:5f:ac:7f:59:29:6f:41:bb:11:e5:8a:30:1f:b8:d2:f3:c4:7e:bb:15:fa:3e:68:e9:f7:7f:8c:52:39:3b:e2:22:17:5d:e4:a7:bc:55:d9:9d:51:80:1b:5a:1d:be:72:dd:6e:ff:ae:52:39:f3:a4:48:d3:e9:ef:5a:a1:c9:54:5e:1a:38:49:18:9b:e6:3c:49:fe:3b:94:92:54:d4:20:d9:81:76:77:a7:db:4a:d1:f3:f5:df:99:b3:25:7d:d6:04:c5:72:ce:e2:5e:43:c2:69:43:cf:d1:64:91:80:3b".replace(":",""),0)

```
<p>Hasil</p>
<pre>
n1 = 554264859105764813308660999731057971935100899008191382001838196926947542874512190874402841957978974562758951331436856029517893995971179950228409634742368823490858553015862605452077729540463185207987338059905256552215054036643656077780363670065154151957507791559734841291875379738678210733333998195096643491711
e1 = 37507589401
n2 = 554264859105764813308660999731057971935100899008191382001838196926947542874512190874402841957978974562758951331436856029517893995971179950228409634742368823490858553015862605452077729540463185207987338059905256552215054036643656077780363670065154151957507791559734841291875379738678210733333998195096643491711
e2 = 4268405784672563577566143285906824408738650526784746749170468318123056940297449811287105187623419766934370809781249030117023876215912795037797160740003478418767197450012472858547143622542113157392499087427939336504102036205305906052998841826136038160560099357503377453502865716581429205507834478651
</pre>
<p>Lanjut dengan generate privatekey(d), bisa kita asumsikan karena disana terdapat big eksponen(e) 
maka privatekey(d) jauh lebih kecil dibandingkan eksponen(d), yang artinya kita akan melakukan <a href="https://en.wikipedia.org/wiki/Wiener%27s_attack">wiener_attack</a> untuk generate privatekey(d)</p>  

```python
import owiener

n = 554264859105764813308660999731057971935100899008191382001838196926947542874512190874402841957978974562758951331436856029517893995971179950228409634742368823490858553015862605452077729540463185207987338059905256552215054036643656077780363670065154151957507791559734841291875379738678210733333998195096643491711
e1 = 37507589401
e2 = 4268405784672563577566143285906824408738650526784746749170468318123056940297449811287105187623419766934370809781249030117023876215912795037797160740003478418767197450012472858547143622542113157392499087427939336504102036205305906052998841826136038160560099357503377453502865716581429205507834478651
e = e1*e2
d = owiener.attack(e, n)
print(d)
```
<p>Hasil</p>
<pre>
d = 26303119241915216199594566239456133498871761271858884214528771406917554649451
</pre>
<p>Lanjut, Generate nilai desimal dari file flag.enc</p>
<p>flag.enc</p>
<p align="center">
  <img src="https://github.com/enomarozi/RSA-CTF-Writeup/blob/master/RSA/Image/Complex%20RSA1.png">
</p>

```python
file = list(open("flag.enc","rb").read())
generate = ""
for i in file:
    generate += str(hex(i)[2:].rjust(2,"0"))
print(int("0x"+generate,0))
```
<p>Hasil</p>
<pre>
c = 480913206616481136975437460267622965008168717609391703766904338457154776519878792331753662308305002611889672567979124032034910186633412102770425587320566951169520265464862579359466224887642685961029180541669279628185621980472401577946294813679654553588719546866573495461081748127987979738136330726284292334887
</pre>
<p>Terakhir, lakukan decrypt terhadap ciphertext(c)</p>

```python
c = 480913206616481136975437460267622965008168717609391703766904338457154776519878792331753662308305002611889672567979124032034910186633412102770425587320566951169520265464862579359466224887642685961029180541669279628185621980472401577946294813679654553588719546866573495461081748127987979738136330726284292334887
d = 26303119241915216199594566239456133498871761271858884214528771406917554649451
n = 554264859105764813308660999731057971935100899008191382001838196926947542874512190874402841957978974562758951331436856029517893995971179950228409634742368823490858553015862605452077729540463185207987338059905256552215054036643656077780363670065154151957507791559734841291875379738678210733333998195096643491711
print(bytes.fromhex(hex(pow(c,d,n))[2:]))
```
<h3><b>Flag</b></h3>
<pre>
CTF{c0n6r47zzz_y0u_f0und_0ur_h1dd3n_w13n3r!!}
</pre>
